"""
上市公司专利名称以及IPC类别爬取
author：hanlinqi
date：2021/1/1/10
"""
from bs4 import BeautifulSoup
import requests
import pandas as pd
import time
import random
from multiprocessing import Pool


class TianYanCha(object):
    def __init__(self):
        self.base_url = 'https://zhuanli.tianyancha.com/search/d2007-2019'
        # cookie池，需要在天眼查注册账户 天眼查通过cookie进行反爬
        # 动态不定时切换cookie使其无法识别，需要自己获取
        self.cookie = [
            'auth_token=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxODkxNDcyMDE4MiIsImlhdCI6MTYxMDQ0Mzc2OSwiZXhwIjoxNjQxOTc5NzY5fQ.a_nUdUdjdH6DJAo9HGI-iHGuLZYzOCkey0yl4XCj_MRSzL8EdMO60PZyPwUMh86MpiuMTMzDAKFnKHi0R0XXhA; TYCID=b6ffd52054b711eb957419cbfb1e7304; tyc-user-info-save-time=1610443773630; searchSessionId=1610443840.70997391; sensorsdata2015jssdkcross=%7B%22distinct_id%22%3A%22176f5e7b2ef5d0-04558e5b922c3b-7140593a-1049088-176f5e7b2f0e9%22%2C%22first_id%22%3A%22%22%2C%22props%22%3A%7B%22%24latest_traffic_source_type%22%3A%22%E7%9B%B4%E6%8E%A5%E6%B5%81%E9%87%8F%22%2C%22%24latest_search_keyword%22%3A%22%E6%9C%AA%E5%8F%96%E5%88%B0%E5%80%BC_%E7%9B%B4%E6%8E%A5%E6%89%93%E5%BC%80%22%2C%22%24latest_referrer%22%3A%22%22%7D%2C%22%24device_id%22%3A%22176f5e7b2ef5d0-04558e5b922c3b-7140593a-1049088-176f5e7b2f0e9%22%7D; _gid=GA1.2.1137404636.1610443373; tyc-user-phone=%255B%252218914720182%2522%255D; ssuid=9278863600; _ga=GA1.2.1915191964.1610443373; Hm_lvt_e92c8d65d92d534b0fc290df538b4758=1610443372; tyc-user-info={%22claimEditPoint%22:%220%22%2C%22vipToMonth%22:%22false%22%2C%22explainPoint%22:%220%22%2C%22personalClaimType%22:%22none%22%2C%22integrity%22:%2210%25%22%2C%22state%22:0%2C%22score%22:%220%22%2C%22announcementPoint%22:%220%22%2C%22messageShowRedPoint%22:%220%22%2C%22bidSubscribe%22:%22-1%22%2C%22vipManager%22:%220%22%2C%22monitorUnreadCount%22:%220%22%2C%22discussCommendCount%22:%220%22%2C%22onum%22:%220%22%2C%22showPost%22:null%2C%22messageBubbleCount%22:%220%22%2C%22claimPoint%22:%220%22%2C%22token%22:%22eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxODkxNDcyMDE4MiIsImlhdCI6MTYxMDQ0Mzc2OSwiZXhwIjoxNjQxOTc5NzY5fQ.a_nUdUdjdH6DJAo9HGI-iHGuLZYzOCkey0yl4XCj_MRSzL8EdMO60PZyPwUMh86MpiuMTMzDAKFnKHi0R0XXhA%22%2C%22schoolAuthStatus%22:%222%22%2C%22userId%22:%22223823128%22%2C%22scoreUnit%22:%22%22%2C%22redPoint%22:%220%22%2C%22myTidings%22:%220%22%2C%22companyAuthStatus%22:%222%22%2C%22originalScore%22:%220%22%2C%22myAnswerCount%22:%220%22%2C%22myQuestionCount%22:%220%22%2C%22signUp%22:%221%22%2C%22privateMessagePointWeb%22:%220%22%2C%22nickname%22:%22%E6%85%8E%22%2C%22privateMessagePoint%22:%220%22%2C%22bossStatus%22:%222%22%2C%22isClaim%22:%220%22%2C%22yellowDiamondEndTime%22:%220%22%2C%22new%22:%221%22%2C%22yellowDiamondStatus%22:%22-1%22%2C%22pleaseAnswerCount%22:%220%22%2C%22bizCardUnread%22:%220%22%2C%22vnum%22:%220%22%2C%22mobile%22:%2218914720182%22%2C%22riskManagement%22:{%22servicePhone%22:null%2C%22mobile%22:18914720182%2C%22title%22:null%2C%22currentStatus%22:null%2C%22lastStatus%22:null%2C%22quickReturn%22:false%2C%22oldVersionMessage%22:null%2C%22riskMessage%22:null}}; jsid=SEM-BAIDU-PP-VIP-301001; aliyungf_tc=ef112bba403f69862a41f32f733b9def94a21e0dc5cc0e9d221896fca9cddd86; csrfToken=xFkWk2nAt0Q-WvyyY21kg1Gr; bannerFlag=false; acw_tc=2f6fc10816105963013682472e99d4ab385cc008e864db9ed2196121fd04b7; Hm_lvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610578174,1610578178,1610589047,1610596308; Hm_lpvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610596308',
            # 'csrfToken=h9BmKiCSRuDTinza-xlNbWY2; TYCID=4636038054b911eb97653d4c1fd26ee0; sensorsdata2015jssdkcross=%7B%22distinct_id%22%3A%22176f5f1cc38766-0f188e8e2e06fd-c791039-1049088-176f5f1cc398f1%22%2C%22first_id%22%3A%22%22%2C%22props%22%3A%7B%22%24latest_traffic_source_type%22%3A%22%E7%9B%B4%E6%8E%A5%E6%B5%81%E9%87%8F%22%2C%22%24latest_search_keyword%22%3A%22%E6%9C%AA%E5%8F%96%E5%88%B0%E5%80%BC_%E7%9B%B4%E6%8E%A5%E6%89%93%E5%BC%80%22%2C%22%24latest_referrer%22%3A%22%22%7D%2C%22%24device_id%22%3A%22176f5f1cc38766-0f188e8e2e06fd-c791039-1049088-176f5f1cc398f1%22%7D; ssuid=2060037324; _ga=GA1.2.958098366.1610444036; _gid=GA1.2.1217612076.1610444036; token=a69c1442f5674cfc8935354c3db8514c; _utm=80045a7ad838408d8de9dd5b46b705a9; auth_token=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxNTM4MjM2MjcwMyIsImlhdCI6MTYxMDQ0NDE3NSwiZXhwIjoxNjQxOTgwMTc1fQ.qIUFDjpVn4FogSJiQ4fRhnYlHAaro-vul6djwmWaFB_vmHDl7xsd1SpaMlmJkP4Da_6VVqsRcYx2pzqr6P2hUg; tyc-user-info={%22claimEditPoint%22:%220%22%2C%22vipToMonth%22:%22false%22%2C%22explainPoint%22:%220%22%2C%22personalClaimType%22:%22none%22%2C%22integrity%22:%2210%25%22%2C%22state%22:%220%22%2C%22score%22:%220%22%2C%22announcementPoint%22:%220%22%2C%22messageShowRedPoint%22:%220%22%2C%22bidSubscribe%22:%22-1%22%2C%22vipManager%22:%220%22%2C%22monitorUnreadCount%22:%220%22%2C%22discussCommendCount%22:%220%22%2C%22onum%22:%220%22%2C%22showPost%22:null%2C%22messageBubbleCount%22:%220%22%2C%22claimPoint%22:%220%22%2C%22token%22:%22eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxNTM4MjM2MjcwMyIsImlhdCI6MTYxMDQ0NDE3NSwiZXhwIjoxNjQxOTgwMTc1fQ.qIUFDjpVn4FogSJiQ4fRhnYlHAaro-vul6djwmWaFB_vmHDl7xsd1SpaMlmJkP4Da_6VVqsRcYx2pzqr6P2hUg%22%2C%22schoolAuthStatus%22:%222%22%2C%22userId%22:%22223298995%22%2C%22scoreUnit%22:%22%22%2C%22redPoint%22:%220%22%2C%22myTidings%22:%220%22%2C%22companyAuthStatus%22:%222%22%2C%22originalScore%22:%220%22%2C%22myAnswerCount%22:%220%22%2C%22myQuestionCount%22:%220%22%2C%22signUp%22:%220%22%2C%22privateMessagePointWeb%22:%220%22%2C%22nickname%22:%22%E7%9B%96%E4%BC%A6%22%2C%22privateMessagePoint%22:%220%22%2C%22bossStatus%22:%222%22%2C%22isClaim%22:%220%22%2C%22yellowDiamondEndTime%22:%220%22%2C%22yellowDiamondStatus%22:%22-1%22%2C%22pleaseAnswerCount%22:%220%22%2C%22bizCardUnread%22:%220%22%2C%22vnum%22:%220%22%2C%22mobile%22:%2215382362703%22%2C%22riskManagement%22:{%22servicePhone%22:null%2C%22mobile%22:15382362703%2C%22title%22:null%2C%22currentStatus%22:null%2C%22lastStatus%22:null%2C%22quickReturn%22:false%2C%22oldVersionMessage%22:null%2C%22riskMessage%22:null}}; tyc-user-phone=%255B%252215382362703%2522%255D; bannerFlag=true; Hm_lpvt_e92c8d65d92d534b0fc290df538b4758=1610447119; Hm_lvt_e92c8d65d92d534b0fc290df538b4758=1610447119; aliyungf_tc=5e645c9b3971c548edc98dd3fcadf817c431c403d33ee450e18dd8dd954ef64c; acw_tc=2f6fc10816105963027097424e99b7dcdf8966666e3a1d7448c672fad3dfcb; Hm_lvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610564906,1610578170,1610589051,1610596311; Hm_lpvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610596311',
            # 'TYCID=ca198e70557111eb8affafc77c825ec4; sensorsdata2015jssdkcross=%7B%22distinct_id%22%3A%22176faaafca7752-0ce6e8b9a02dcb-3e604809-1049088-176faaafca8824%22%2C%22first_id%22%3A%22%22%2C%22props%22%3A%7B%22%24latest_traffic_source_type%22%3A%22%E7%9B%B4%E6%8E%A5%E6%B5%81%E9%87%8F%22%2C%22%24latest_search_keyword%22%3A%22%E6%9C%AA%E5%8F%96%E5%88%B0%E5%80%BC_%E7%9B%B4%E6%8E%A5%E6%89%93%E5%BC%80%22%2C%22%24latest_referrer%22%3A%22%22%7D%2C%22%24device_id%22%3A%22176faaafca7752-0ce6e8b9a02dcb-3e604809-1049088-176faaafca8824%22%7D; ssuid=4666236008; _ga=GA1.2.931642293.1610523279; _gid=GA1.2.1596190865.1610523279; tyc-user-phone=%255B%252218651588406%2522%255D; csrfToken=GllOtbaNG3KlMGn-KFb2BLBx; aliyungf_tc=005c5f5c183005e37bfd78d65776916621a66135bff444999ba876c536f35388; bannerFlag=true; Hm_lvt_e92c8d65d92d534b0fc290df538b4758=1610525381,1610596311; Hm_lpvt_e92c8d65d92d534b0fc290df538b4758=1610631808; tyc-user-info={%22claimEditPoint%22:%220%22%2C%22schoolName%22:%22%E6%B1%9F%E5%8D%97%E5%A4%A7%E5%AD%A6%22%2C%22personalClaimType%22:%22none%22%2C%22integrity%22:%2280%25%22%2C%22score%22:%22910%22%2C%22announcementPoint%22:%220%22%2C%22bidSubscribe%22:%22-1%22%2C%22onum%22:%2218%22%2C%22monitorUnreadCount%22:%227%22%2C%22messageBubbleCount%22:%220%22%2C%22claimPoint%22:%220%22%2C%22schoolAuthStatus%22:%222%22%2C%22userId%22:%22645473%22%2C%22vipToTime%22:%221626942740919%22%2C%22schoolLogo%22:%22https://img5.tianyancha.com/school_logo/33871bf7bc2172885ca4451b44e95a21_gkcx.png@!f_200x200%22%2C%22scoreUnit%22:%22%22%2C%22redPoint%22:%220%22%2C%22industry%22:%22%E8%B4%B8%E6%98%93/%E6%89%B9%E5%8F%91/%E9%9B%B6%E5%94%AE%22%2C%22myTidings%22:%220%22%2C%22companyAuthStatus%22:%222%22%2C%22graduateYear%22:%222007%22%2C%22myAnswerCount%22:%220%22%2C%22nickname%22:%22%E4%BB%B2%E8%81%AA%22%2C%22privateMessagePoint%22:%220%22%2C%22isClaim%22:%220%22%2C%22companyName%22:%22%E6%97%A0%E9%94%A1%E7%BB%87%E6%81%A9%E8%87%BB%E5%95%86%E8%B4%B8%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22%2C%22isExpired%22:%220%22%2C%22mobile%22:%2218651588406%22%2C%22riskManagement%22:{%22servicePhone%22:null%2C%22mobile%22:18651588406%2C%22title%22:null%2C%22currentStatus%22:null%2C%22lastStatus%22:null%2C%22quickReturn%22:false%2C%22oldVersionMessage%22:null%2C%22riskMessage%22:null}%2C%22vipToMonth%22:%22false%22%2C%22explainPoint%22:%220%22%2C%22state%22:%225%22%2C%22schoolGid%22:%22507375487%22%2C%22surday%22:%22189%22%2C%22messageShowRedPoint%22:%220%22%2C%22vipManager%22:%220%22%2C%22discussCommendCount%22:%220%22%2C%22identity%22:%22%E5%91%98%E5%B7%A5%22%2C%22showPost%22:%22%E8%91%A3%E4%BA%8B%E9%95%BF%22%2C%22token%22:%22eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxODY1MTU4ODQwNiIsImlhdCI6MTYxMDYzNDcyNCwiZXhwIjoxNjQyMTcwNzI0fQ.SHareaCUITuW43KTUDFwPbjA2FGHmeEQA2xYIP2GuMKh8cvcJX6dKnB3b1yAViaeI4CBLXHeEdW-_XHMvu0iVg%22%2C%22companyAlias%22:%22%E7%BB%87%E6%81%A9%E8%87%BB%22%2C%22originalScore%22:%22910%22%2C%22post%22:%22%E8%91%A3%E4%BA%8B%E9%95%BF%22%2C%22myQuestionCount%22:%220%22%2C%22signUp%22:%220%22%2C%22privateMessagePointWeb%22:%220%22%2C%22headPicUrl%22:%22https://cdn.tianyancha.com/user/headpic/18932066c55d4b7d90c9f87f5face9fd.png%22%2C%22bossStatus%22:%222%22%2C%22educationBackground%22:%22%E6%88%90%E4%BA%BA%E6%9C%AC%E7%A7%91%22%2C%22yellowDiamondEndTime%22:%220%22%2C%22yellowDiamondStatus%22:%22-1%22%2C%22companyLogo%22:%22https://img5.tianyancha.com/logo/lll/320f261e5b6fd9def7fe0080b031d3a3.png@!f_200x200%22%2C%22pleaseAnswerCount%22:%220%22%2C%22vnum%22:%220%22%2C%22bizCardUnread%22:%220%22%2C%22companyGid%22:%223344513622%22}; tyc-user-info-save-time=1610634726132; auth_token=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxODY1MTU4ODQwNiIsImlhdCI6MTYxMDYzNDcyNCwiZXhwIjoxNjQyMTcwNzI0fQ.SHareaCUITuW43KTUDFwPbjA2FGHmeEQA2xYIP2GuMKh8cvcJX6dKnB3b1yAViaeI4CBLXHeEdW-_XHMvu0iVg; acw_tc=781bad0f16106347251354197e30026c5f80527d64a05e39ac04b3e98b02d6; Hm_lvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610623358,1610624450,1610624624,1610634728; Hm_lpvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610634728; _gat_gtag_UA_123487620_1=1',
            # 'None',
            #
            # 'aliyungf_tc=de95791c06135c58be82eb92cb4b31c45faa11a2abcc47294de378d1d8161e49; csrfToken=4OuxAJPYXL55tBt1EzMn2Wn6; TYCID=d3262340564b11eb9ca5c55725452e12; ssuid=7077724850; sensorsdata2015jssdkcross=%7B%22distinct_id%22%3A%22177003ff04e3ec-0526e18274618b-33524d7c-1049088-177003ff04f2c1%22%2C%22first_id%22%3A%22%22%2C%22props%22%3A%7B%22%24latest_traffic_source_type%22%3A%22%E7%9B%B4%E6%8E%A5%E6%B5%81%E9%87%8F%22%2C%22%24latest_search_keyword%22%3A%22%E6%9C%AA%E5%8F%96%E5%88%B0%E5%80%BC_%E7%9B%B4%E6%8E%A5%E6%89%93%E5%BC%80%22%2C%22%24latest_referrer%22%3A%22%22%7D%2C%22%24device_id%22%3A%22177003ff04e3ec-0526e18274618b-33524d7c-1049088-177003ff04f2c1%22%7D; bannerFlag=true; Hm_lvt_e92c8d65d92d534b0fc290df538b4758=1610616927; _ga=GA1.2.285715350.1610616928; _gid=GA1.2.839122121.1610616928; tyc-user-phone=%255B%252215962302751%2522%255D; Hm_lpvt_e92c8d65d92d534b0fc290df538b4758=1610769173; tyc-user-info={%22claimEditPoint%22:%220%22%2C%22schoolName%22:%22%E5%B8%B8%E7%86%9F%E7%90%86%E5%B7%A5%E5%AD%A6%E9%99%A2%22%2C%22personalClaimType%22:%22boss%22%2C%22integrity%22:%2270%25%22%2C%22score%22:%228976%22%2C%22announcementPoint%22:%220%22%2C%22bidSubscribe%22:%22-1%22%2C%22onum%22:%2238%22%2C%22monitorUnreadCount%22:%222%22%2C%22messageBubbleCount%22:%220%22%2C%22claimPoint%22:%220%22%2C%22schoolAuthStatus%22:%221%22%2C%22userId%22:%224971480%22%2C%22vipToTime%22:%221657947367774%22%2C%22scoreUnit%22:%22%22%2C%22schoolLogo%22:%22https://img5.tianyancha.com/school_logo/f01f3768de9efeccb7d1d6fd2b64ebcc_gkcx.png@!f_200x200%22%2C%22industry%22:%22%E5%88%B6%E9%80%A0%E4%B8%9A%22%2C%22redPoint%22:%220%22%2C%22myTidings%22:%221%22%2C%22companyAuthStatus%22:%222%22%2C%22graduateYear%22:%222014%22%2C%22myAnswerCount%22:%221%22%2C%22nickname%22:%22%E5%BE%90jy%22%2C%22privateMessagePoint%22:%220%22%2C%22isClaim%22:%222%22%2C%22companyName%22:%22%E5%B8%B8%E7%86%9F%E5%88%A9%E5%87%86%E6%9C%BA%E7%94%B5%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8%22%2C%22isExpired%22:%220%22%2C%22mobile%22:%2215962302751%22%2C%22riskManagement%22:{%22servicePhone%22:null%2C%22mobile%22:15962302751%2C%22title%22:null%2C%22currentStatus%22:null%2C%22lastStatus%22:null%2C%22quickReturn%22:false%2C%22oldVersionMessage%22:null%2C%22riskMessage%22:null}%2C%22vipToMonth%22:%22false%22%2C%22explainPoint%22:%220%22%2C%22state%22:%227%22%2C%22schoolGid%22:%222335331215%22%2C%22surday%22:%22547%22%2C%22messageShowRedPoint%22:%220%22%2C%22vipManager%22:%220%22%2C%22discussCommendCount%22:%221%22%2C%22showPost%22:%22%E6%B3%95%E5%AE%9A%E4%BB%A3%E8%A1%A8%E4%BA%BA%22%2C%22identity%22:%22%E6%B3%95%E5%AE%9A%E4%BB%A3%E8%A1%A8%E4%BA%BA%22%2C%22token%22:%22eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxNTk2MjMwMjc1MSIsImlhdCI6MTYxMDc2OTE4MiwiZXhwIjoxNjQyMzA1MTgyfQ.QVpAmIAumd1lYTCpuMlZxlV5zufnbAXiPk_MBEq_3UecQfIluFyeONr1IAcxOji9GgvpHB1qxctsIvDQ95Fqvw%22%2C%22companyAlias%22:%22%E5%88%A9%E5%87%86%E6%9C%BA%E7%94%B5%22%2C%22originalScore%22:%228976%22%2C%22myQuestionCount%22:%220%22%2C%22signUp%22:%220%22%2C%22privateMessagePointWeb%22:%220%22%2C%22bossStatus%22:%221%22%2C%22educationBackground%22:%22%E6%9C%AC%E7%A7%91%22%2C%22yellowDiamondEndTime%22:%220%22%2C%22yellowDiamondStatus%22:%22-1%22%2C%22companyLogo%22:%22https://img5.tianyancha.com/logo/lll/568c7b4fdc7e662b3659d43a9491e366.png@!f_200x200%22%2C%22pleaseAnswerCount%22:%220%22%2C%22vnum%22:%2270%22%2C%22bizCardUnread%22:%220%22%2C%22companyGid%22:%223178600988%22}; tyc-user-info-save-time=1610769182828; auth_token=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxNTk2MjMwMjc1MSIsImlhdCI6MTYxMDc2OTE4MiwiZXhwIjoxNjQyMzA1MTgyfQ.QVpAmIAumd1lYTCpuMlZxlV5zufnbAXiPk_MBEq_3UecQfIluFyeONr1IAcxOji9GgvpHB1qxctsIvDQ95Fqvw; acw_tc=2760824216107705891934565e3dfbb52788236da3f014c6595e212a012a2d; Hm_lvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610769184,1610769186,1610769200,1610770591; Hm_lpvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610770591',
            #
            # 'TYCID=e1c0c08053f911eb846873a9506b13d1; ssuid=9363533504; _gid=GA1.2.2104040187.1610361827; _ga=GA1.2.5377413.1610361827; csrfToken=GxpIpiaYQpwIhjoQHrFiEjvt; bannerFlag=true; jsid=SEO-GOOGLE-ALL-SY-000001; searchSessionId=1610441742.58348012; tyc-user-phone=%255B%252215829907001%2522%252C%2522153%25208236%25202703%2522%255D; token=171dabe85a2840e292c489b60793d446; _utm=2b3f5f9214e848409154ad4ecb623513; aliyungf_tc=822d6a12d22e518d014d3543bebb0fb5f5057c52c98d7c362ead58deab678d04; bad_id658cce70-d9dc-11e9-96c6-833900356dc6=8475a1c1-5548-11eb-b03c-fdce6fb5c21b; nice_id658cce70-d9dc-11e9-96c6-833900356dc6=8475a1c2-5548-11eb-b03c-fdce6fb5c21b; Hm_lvt_e92c8d65d92d534b0fc290df538b4758=1610441036,1610505916,1610516318,1610516586; tyc-user-info={%22claimEditPoint%22:%220%22%2C%22vipToMonth%22:%22false%22%2C%22explainPoint%22:%220%22%2C%22personalClaimType%22:%22none%22%2C%22integrity%22:%2210%25%22%2C%22state%22:0%2C%22score%22:%225%22%2C%22announcementPoint%22:%220%22%2C%22messageShowRedPoint%22:%220%22%2C%22bidSubscribe%22:%22-1%22%2C%22vipManager%22:%220%22%2C%22monitorUnreadCount%22:%220%22%2C%22discussCommendCount%22:%220%22%2C%22onum%22:%220%22%2C%22showPost%22:null%2C%22messageBubbleCount%22:%220%22%2C%22claimPoint%22:%220%22%2C%22token%22:%22eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxNTgyOTkwNzAwMSIsImlhdCI6MTYxMDQ0NDE3OCwiZXhwIjoxNjQxOTgwMTc4fQ.zqRMcEzZTM7ridiCIqOCIfzABOC_i1ZEwdaprfTj_zJLezGesCHVQhTTnHCl-d1Yf2IdECjvalfzL3D7RXIWyg%22%2C%22schoolAuthStatus%22:%222%22%2C%22userId%22:%222656200%22%2C%22scoreUnit%22:%22%22%2C%22redPoint%22:%220%22%2C%22myTidings%22:%220%22%2C%22companyAuthStatus%22:%222%22%2C%22originalScore%22:%225%22%2C%22myAnswerCount%22:%220%22%2C%22myQuestionCount%22:%220%22%2C%22signUp%22:%220%22%2C%22privateMessagePointWeb%22:%220%22%2C%22nickname%22:%22%E5%9F%83%E5%BE%B7%E6%96%87%C2%B7%E8%8C%83%E5%BE%B7%E8%90%A8%22%2C%22privateMessagePoint%22:%220%22%2C%22bossStatus%22:%222%22%2C%22isClaim%22:%220%22%2C%22yellowDiamondEndTime%22:%220%22%2C%22yellowDiamondStatus%22:%22-1%22%2C%22pleaseAnswerCount%22:%220%22%2C%22bizCardUnread%22:%220%22%2C%22vnum%22:%220%22%2C%22mobile%22:%2215829907001%22%2C%22riskManagement%22:{%22servicePhone%22:null%2C%22mobile%22:15829907001%2C%22title%22:null%2C%22currentStatus%22:null%2C%22lastStatus%22:null%2C%22quickReturn%22:false%2C%22oldVersionMessage%22:null%2C%22riskMessage%22:null}}; tyc-user-info-save-time=1610516862161; auth_token=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxNTgyOTkwNzAwMSIsImlhdCI6MTYxMDQ0NDE3OCwiZXhwIjoxNjQxOTgwMTc4fQ.zqRMcEzZTM7ridiCIqOCIfzABOC_i1ZEwdaprfTj_zJLezGesCHVQhTTnHCl-d1Yf2IdECjvalfzL3D7RXIWyg; Hm_lpvt_e92c8d65d92d534b0fc290df538b4758=1610516863; Hm_lvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610524028,1610524884,1610525366,1610525530; bannerHide=15829907001; acw_tc=2760822616105472213121432e481398d3db523570baffbccc259bf2bf9341; sensorsdata2015jssdkcross=%7B%22distinct_id%22%3A%22176f10b6aad0-0f2b63163bba3f-31346d-921600-176f10b6aae4cd%22%2C%22first_id%22%3A%22%22%2C%22props%22%3A%7B%22%24latest_traffic_source_type%22%3A%22%E7%9B%B4%E6%8E%A5%E6%B5%81%E9%87%8F%22%2C%22%24latest_search_keyword%22%3A%22%E6%9C%AA%E5%8F%96%E5%88%B0%E5%80%BC_%E7%9B%B4%E6%8E%A5%E6%89%93%E5%BC%80%22%2C%22%24latest_referrer%22%3A%22%22%7D%2C%22%24device_id%22%3A%22176f10b6aad0-0f2b63163bba3f-31346d-921600-176f10b6aae4cd%22%7D; Hm_lpvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610547222',
            # 'TYCID=6c6a0be0553c11ebb30751abfbe2c3a4; sajssdk_2015_cross_new_user=1; sensorsdata2015jssdkcross=%7B%22distinct_id%22%3A%22176f94d3f55718-04864b70e98994-3e604809-921600-176f94d3f5661f%22%2C%22first_id%22%3A%22%22%2C%22props%22%3A%7B%22%24latest_traffic_source_type%22%3A%22%E7%9B%B4%E6%8E%A5%E6%B5%81%E9%87%8F%22%2C%22%24latest_search_keyword%22%3A%22%E6%9C%AA%E5%8F%96%E5%88%B0%E5%80%BC_%E7%9B%B4%E6%8E%A5%E6%89%93%E5%BC%80%22%2C%22%24latest_referrer%22%3A%22%22%7D%2C%22%24device_id%22%3A%22176f94d3f55718-04864b70e98994-3e604809-921600-176f94d3f5661f%22%7D; ssuid=9810718294; _ga=GA1.2.851699487.1610500359; _gid=GA1.2.1858176563.1610500359; tyc-user-info={%22claimEditPoint%22:%220%22%2C%22vipToMonth%22:%22false%22%2C%22explainPoint%22:%220%22%2C%22personalClaimType%22:%22none%22%2C%22integrity%22:%2210%25%22%2C%22state%22:%220%22%2C%22score%22:%220%22%2C%22announcementPoint%22:%220%22%2C%22messageShowRedPoint%22:%220%22%2C%22bidSubscribe%22:%22-1%22%2C%22vipManager%22:%220%22%2C%22monitorUnreadCount%22:%220%22%2C%22discussCommendCount%22:%220%22%2C%22onum%22:%220%22%2C%22showPost%22:null%2C%22messageBubbleCount%22:%220%22%2C%22claimPoint%22:%220%22%2C%22token%22:%22eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxOTk3NTI2MDcxNyIsImlhdCI6MTYxMDUwMDYzNiwiZXhwIjoxNjQyMDM2NjM2fQ.4-mHYYr1R9--0QYNtdx0u1n84snKD9TrP6YvzU_a63YGrI9t1430HUxpyDSZbPqG_uSOCK4U-EYCGIvv32piQg%22%2C%22schoolAuthStatus%22:%222%22%2C%22userId%22:%22229857953%22%2C%22scoreUnit%22:%22%22%2C%22redPoint%22:%220%22%2C%22myTidings%22:%220%22%2C%22companyAuthStatus%22:%222%22%2C%22originalScore%22:%220%22%2C%22myAnswerCount%22:%220%22%2C%22myQuestionCount%22:%220%22%2C%22signUp%22:%220%22%2C%22privateMessagePointWeb%22:%220%22%2C%22nickname%22:%22%E8%8E%AB%E5%BE%B7%E5%87%AF%E6%92%92%22%2C%22privateMessagePoint%22:%220%22%2C%22bossStatus%22:%222%22%2C%22isClaim%22:%220%22%2C%22yellowDiamondEndTime%22:%220%22%2C%22yellowDiamondStatus%22:%22-1%22%2C%22pleaseAnswerCount%22:%220%22%2C%22bizCardUnread%22:%220%22%2C%22vnum%22:%220%22%2C%22mobile%22:%2219975260717%22%2C%22riskManagement%22:{%22servicePhone%22:null%2C%22mobile%22:19975260717%2C%22title%22:null%2C%22currentStatus%22:null%2C%22lastStatus%22:null%2C%22quickReturn%22:false%2C%22oldVersionMessage%22:null%2C%22riskMessage%22:null}}; auth_token=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxOTk3NTI2MDcxNyIsImlhdCI6MTYxMDUwMDYzNiwiZXhwIjoxNjQyMDM2NjM2fQ.4-mHYYr1R9--0QYNtdx0u1n84snKD9TrP6YvzU_a63YGrI9t1430HUxpyDSZbPqG_uSOCK4U-EYCGIvv32piQg; tyc-user-phone=%255B%252219975260717%2522%255D; csrfToken=Xkj70L6W3g_UhN2Jeyw0_OGT; Hm_lvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610526869,1610528194,1610529481,1610529802; Hm_lpvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610547110',
            # 'jsid=SEO-BING-ALL-SY-000001; TYCID=9c73cde0535611eb8e1c25b31e4ea8be; ssuid=8230189992; _ga=GA1.2.39729884.1610291704; _gid=GA1.2.353482130.1610291704; auth_token=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxNzM2NDUyMDQ3OSIsImlhdCI6MTYxMDI5MTg2OSwiZXhwIjoxNjQxODI3ODY5fQ.udxjwQkXU1z6H1LcZSucKLuJNRxTaKi0t89hTVnTxCq_DLvNpAolpUIGQN-0s-pob-Vjw72L3h1ODHNPrwQJNw; tyc-user-info={%22claimEditPoint%22:%220%22%2C%22vipToMonth%22:%22false%22%2C%22explainPoint%22:%220%22%2C%22personalClaimType%22:%22none%22%2C%22integrity%22:%2210%25%22%2C%22state%22:%220%22%2C%22score%22:%220%22%2C%22announcementPoint%22:%220%22%2C%22messageShowRedPoint%22:%220%22%2C%22bidSubscribe%22:%22-1%22%2C%22vipManager%22:%220%22%2C%22onum%22:%220%22%2C%22monitorUnreadCount%22:%220%22%2C%22discussCommendCount%22:%220%22%2C%22showPost%22:null%2C%22messageBubbleCount%22:%220%22%2C%22claimPoint%22:%220%22%2C%22token%22:%22eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxNzM2NDUyMDQ3OSIsImlhdCI6MTYxMDI5MTg2OSwiZXhwIjoxNjQxODI3ODY5fQ.udxjwQkXU1z6H1LcZSucKLuJNRxTaKi0t89hTVnTxCq_DLvNpAolpUIGQN-0s-pob-Vjw72L3h1ODHNPrwQJNw%22%2C%22schoolAuthStatus%22:%222%22%2C%22userId%22:%22230638819%22%2C%22scoreUnit%22:%22%22%2C%22redPoint%22:%220%22%2C%22myTidings%22:%220%22%2C%22companyAuthStatus%22:%222%22%2C%22originalScore%22:%220%22%2C%22myAnswerCount%22:%220%22%2C%22myQuestionCount%22:%220%22%2C%22signUp%22:%221%22%2C%22privateMessagePointWeb%22:%220%22%2C%22nickname%22:%22%E9%94%90%E9%9B%AF%22%2C%22privateMessagePoint%22:%220%22%2C%22bossStatus%22:%222%22%2C%22isClaim%22:%220%22%2C%22yellowDiamondEndTime%22:%220%22%2C%22new%22:%221%22%2C%22yellowDiamondStatus%22:%22-1%22%2C%22pleaseAnswerCount%22:%220%22%2C%22bizCardUnread%22:%220%22%2C%22vnum%22:%220%22%2C%22mobile%22:%2217364520479%22%2C%22riskManagement%22:{%22servicePhone%22:null%2C%22mobile%22:17364520479%2C%22title%22:null%2C%22currentStatus%22:null%2C%22lastStatus%22:null%2C%22quickReturn%22:false%2C%22oldVersionMessage%22:null%2C%22riskMessage%22:null}}; tyc-user-phone=%255B%252217364520479%2522%255D; sensorsdata2015jssdkcross=%7B%22distinct_id%22%3A%22176ecdd6d2ab70-0f492059f01b79-7d677965-1638720-176ecdd6d2b7b0%22%2C%22first_id%22%3A%22%22%2C%22props%22%3A%7B%22%24latest_traffic_source_type%22%3A%22%E7%9B%B4%E6%8E%A5%E6%B5%81%E9%87%8F%22%2C%22%24latest_search_keyword%22%3A%22%E6%9C%AA%E5%8F%96%E5%88%B0%E5%80%BC_%E7%9B%B4%E6%8E%A5%E6%89%93%E5%BC%80%22%2C%22%24latest_referrer%22%3A%22%22%7D%2C%22%24device_id%22%3A%22176ecdd6d2ab70-0f492059f01b79-7d677965-1638720-176ecdd6d2b7b0%22%7D; searchSessionId=1610295969.11144718; Hm_lvt_e92c8d65d92d534b0fc290df538b4758=1610295970; bad_id658cce70-d9dc-11e9-96c6-833900356dc6=66ab9ec1-54b1-11eb-a0e7-fdb7b806866e; aliyungf_tc=ceb0ad581c13fcd2e6c1ec0052956425c492faed1bb031f6246ac0d18fdeecbe; csrfToken=iG_rcDjVXU9FztfgRU_E4eTi; bannerFlag=false; Hm_lvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610542675,1610545402,1610546932,1610547112; Hm_lpvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610547112',
            # 'bannerFlag=false; auth_token=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxMzUyMDg4OTkwMCIsImlhdCI6MTYxMDUyODI5NCwiZXhwIjoxNjQyMDY0Mjk0fQ.DoMm8AmonXBoNnn9c7xR2SrTdeuS36DTjx8HuKkrEHVkRArBFC5FFLkMWT7O5Wji4Uux1HdH7lu-i8BvxaG4ZQ; bad_id658cce70-d9dc-11e9-96c6-833900356dc6=1f84d931-5565-11eb-a49b-454e69ba6cf9; RTYCID=b5cba9c5793a4dfcbe9e79ae11821c55; TYCID=ccaf7830554811eb8affafc77c825ec4; tyc-user-info-save-time=1610528294335; sensorsdata2015jssdkcross=%7B%22distinct_id%22%3A%22176f99e5b7e5c8-069ce4f52f60ba4-2c3d184f-921600-176f99e5b7f6e8%22%2C%22first_id%22%3A%22%22%2C%22props%22%3A%7B%22%24latest_traffic_source_type%22%3A%22%E7%9B%B4%E6%8E%A5%E6%B5%81%E9%87%8F%22%2C%22%24latest_search_keyword%22%3A%22%E6%9C%AA%E5%8F%96%E5%88%B0%E5%80%BC_%E7%9B%B4%E6%8E%A5%E6%89%93%E5%BC%80%22%2C%22%24latest_referrer%22%3A%22%22%7D%2C%22%24device_id%22%3A%22176f99e5b7e5c8-069ce4f52f60ba4-2c3d184f-921600-176f99e5b7f6e8%22%7D; _gid=GA1.2.1793909488.1610505674; CT_TYCID=0e14bbc2f4df4ca58eb5fae3d7f71fbf; tyc-user-phone=%255B%252213520889900%2522%255D; ssuid=9968096504; _ga=GA1.2.142300346.1610505674; Hm_lvt_e92c8d65d92d534b0fc290df538b4758=1610517808; tyc-user-info={%22claimEditPoint%22:%220%22%2C%22explainPoint%22:%220%22%2C%22vipToMonth%22:%22false%22%2C%22personalClaimType%22:%22none%22%2C%22integrity%22:%2210%25%22%2C%22state%22:%225%22%2C%22score%22:%221791%22%2C%22surday%22:%22140%22%2C%22announcementPoint%22:%220%22%2C%22messageShowRedPoint%22:%220%22%2C%22bidSubscribe%22:%22-1%22%2C%22vipManager%22:%220%22%2C%22monitorUnreadCount%22:%2240%22%2C%22discussCommendCount%22:%220%22%2C%22onum%22:%2269%22%2C%22showPost%22:null%2C%22messageBubbleCount%22:%220%22%2C%22claimPoint%22:%220%22%2C%22token%22:%22eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxMzUyMDg4OTkwMCIsImlhdCI6MTYxMDUyODI5NCwiZXhwIjoxNjQyMDY0Mjk0fQ.DoMm8AmonXBoNnn9c7xR2SrTdeuS36DTjx8HuKkrEHVkRArBFC5FFLkMWT7O5Wji4Uux1HdH7lu-i8BvxaG4ZQ%22%2C%22schoolAuthStatus%22:%222%22%2C%22userId%22:%22893748%22%2C%22vipToTime%22:%221622563522471%22%2C%22scoreUnit%22:%22%22%2C%22redPoint%22:%220%22%2C%22myTidings%22:%220%22%2C%22companyAuthStatus%22:%222%22%2C%22originalScore%22:%221791%22%2C%22myAnswerCount%22:%220%22%2C%22myQuestionCount%22:%220%22%2C%22signUp%22:%220%22%2C%22privateMessagePointWeb%22:%220%22%2C%22nickname%22:%22%E4%BC%8F%E7%89%B9%22%2C%22privateMessagePoint%22:%220%22%2C%22bossStatus%22:%222%22%2C%22isClaim%22:%220%22%2C%22yellowDiamondEndTime%22:%220%22%2C%22isExpired%22:%220%22%2C%22yellowDiamondStatus%22:%22-1%22%2C%22pleaseAnswerCount%22:%220%22%2C%22bizCardUnread%22:%220%22%2C%22vnum%22:%2220%22%2C%22mobile%22:%2213520889900%22%2C%22riskManagement%22:{%22servicePhone%22:null%2C%22mobile%22:13520889900%2C%22title%22:null%2C%22currentStatus%22:null%2C%22lastStatus%22:null%2C%22quickReturn%22:false%2C%22oldVersionMessage%22:null%2C%22riskMessage%22:null}}; csrfToken=bOZXNt-fGywhhUSXZZWAo75h; Hm_lpvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610596281; Hm_lvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610529488,1610529809,1610542288,1610542609; acw_tc=2f6fc10816105961301534926e99d204aef856b1e1a26aafe763ace46d5ab8; aliyungf_tc=096f37cc02dd24769224a4688107ae4043e5ddae092e13be3f9b06a321036c90',
            #
            # 'TYCID=f25454f0564411eb9ef4fb5aa1685073; ssuid=2789605120; sensorsdata2015jssdkcross=%7B%22distinct_id%22%3A%221770012dfcf14a-0c806afc8f5195-c7d6957-1638720-1770012dfd03fd%22%2C%22first_id%22%3A%22%22%2C%22props%22%3A%7B%22%24latest_traffic_source_type%22%3A%22%E7%9B%B4%E6%8E%A5%E6%B5%81%E9%87%8F%22%2C%22%24latest_search_keyword%22%3A%22%E6%9C%AA%E5%8F%96%E5%88%B0%E5%80%BC_%E7%9B%B4%E6%8E%A5%E6%89%93%E5%BC%80%22%2C%22%24latest_referrer%22%3A%22%22%7D%2C%22%24device_id%22%3A%221770012dfcf14a-0c806afc8f5195-c7d6957-1638720-1770012dfd03fd%22%7D; _ga=GA1.2.1400093190.1610613974; _gid=GA1.2.2042932934.1610613974; tyc-user-phone=%255B%252215649816677%2522%252C%2522165%25203293%25201218%2522%255D; CT_TYCID=51fbde98ea9b4e76b6a5987dc45f7cb1; RTYCID=5995703df1504184b9e9ba8abf420b51; aliyungf_tc=aee383eef92ba86de07ff7e7be792bf5e87d27fcb2f05ebda7fd3d271628868a; csrfToken=qUty2sNzpqHEJP8SxWc33zPX; bannerFlag=true; Hm_lvt_e92c8d65d92d534b0fc290df538b4758=1610613974,1610643442,1610788982; Hm_lpvt_e92c8d65d92d534b0fc290df538b4758=1610788982; tyc-user-info={%22claimEditPoint%22:%220%22%2C%22contactNumber%22:%2215649816677%22%2C%22explainPoint%22:%220%22%2C%22vipToMonth%22:%22false%22%2C%22personalClaimType%22:%22none%22%2C%22integrity%22:%2210%25%22%2C%22state%22:%223%22%2C%22score%22:%221520%22%2C%22surday%22:%22459%22%2C%22announcementPoint%22:%220%22%2C%22messageShowRedPoint%22:%220%22%2C%22bidSubscribe%22:%22-1%22%2C%22vipManager%22:%220%22%2C%22monitorUnreadCount%22:%2280%22%2C%22discussCommendCount%22:%221%22%2C%22onum%22:%2224%22%2C%22showPost%22:null%2C%22messageBubbleCount%22:%220%22%2C%22claimPoint%22:%220%22%2C%22token%22:%22eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxNTY0OTgxNjY3NyIsImlhdCI6MTYxMDc4ODk4NiwiZXhwIjoxNjQyMzI0OTg2fQ.3askj1riV-5edJYPPYkkvEXFoVpKBoUCBzGU9geMYrztsfhdfhHru53cDruWu92aFsVa0kMix-78WJOCxHNlfw%22%2C%22schoolAuthStatus%22:%222%22%2C%22userId%22:%221425203%22%2C%22vipToTime%22:%221650380485876%22%2C%22scoreUnit%22:%22%22%2C%22redPoint%22:%220%22%2C%22myTidings%22:%221%22%2C%22companyAuthStatus%22:%222%22%2C%22originalScore%22:%221520%22%2C%22myAnswerCount%22:%221%22%2C%22myQuestionCount%22:%220%22%2C%22signUp%22:%220%22%2C%22privateMessagePointWeb%22:%220%22%2C%22nickname%22:%22zb%22%2C%22privateMessagePoint%22:%220%22%2C%22bossStatus%22:%222%22%2C%22isClaim%22:%220%22%2C%22yellowDiamondEndTime%22:%220%22%2C%22isExpired%22:%220%22%2C%22yellowDiamondStatus%22:%22-1%22%2C%22pleaseAnswerCount%22:%220%22%2C%22bizCardUnread%22:%220%22%2C%22vnum%22:%220%22%2C%22mobile%22:%2215649816677%22%2C%22riskManagement%22:{%22servicePhone%22:null%2C%22mobile%22:15649816677%2C%22title%22:null%2C%22currentStatus%22:null%2C%22lastStatus%22:null%2C%22quickReturn%22:false%2C%22oldVersionMessage%22:null%2C%22riskMessage%22:null}}; tyc-user-info-save-time=1610788987218; auth_token=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxNTY0OTgxNjY3NyIsImlhdCI6MTYxMDc4ODk4NiwiZXhwIjoxNjQyMzI0OTg2fQ.3askj1riV-5edJYPPYkkvEXFoVpKBoUCBzGU9geMYrztsfhdfhHru53cDruWu92aFsVa0kMix-78WJOCxHNlfw; acw_tc=2760821916107955101062778e1635e2a487bd71fd4fc27dcc88777d166040; _gat_gtag_UA_123487620_1=1; Hm_lvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610791595,1610792423,1610795512,1610795723; Hm_lpvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610795723',
            #
            # 'TYCID=08cf5aa0559f11ebb86ef93788825ae8; ssuid=6801462983; sensorsdata2015jssdkcross=%7B%22distinct_id%22%3A%22176fbd39c754e9-0619356b03e59b-3a614f0b-1327104-176fbd39c766e7%22%2C%22first_id%22%3A%22%22%2C%22props%22%3A%7B%22%24latest_traffic_source_type%22%3A%22%E7%9B%B4%E6%8E%A5%E6%B5%81%E9%87%8F%22%2C%22%24latest_search_keyword%22%3A%22%E6%9C%AA%E5%8F%96%E5%88%B0%E5%80%BC_%E7%9B%B4%E6%8E%A5%E6%89%93%E5%BC%80%22%2C%22%24latest_referrer%22%3A%22%22%7D%2C%22%24device_id%22%3A%22176fbd39c754e9-0619356b03e59b-3a614f0b-1327104-176fbd39c766e7%22%7D; _ga=GA1.2.2096752327.1610542722; _gid=GA1.2.699253667.1610542722; tyc-user-phone=%255B%252213710718426%2522%255D; bannerFlag=true; Hm_lvt_e92c8d65d92d534b0fc290df538b4758=1610542722,1610724465,1610766106; csrfToken=V9s2ZE6jGsU6Sr9MHTTy31ts; Hm_lpvt_e92c8d65d92d534b0fc290df538b4758=1610769365; tyc-user-info={%22claimEditPoint%22:%220%22%2C%22explainPoint%22:%220%22%2C%22vipToMonth%22:%22false%22%2C%22personalClaimType%22:%22none%22%2C%22integrity%22:%2210%25%22%2C%22state%22:%227%22%2C%22score%22:%221366%22%2C%22surday%22:%22965%22%2C%22announcementPoint%22:%220%22%2C%22messageShowRedPoint%22:%220%22%2C%22bidSubscribe%22:%22-1%22%2C%22vipManager%22:%220%22%2C%22monitorUnreadCount%22:%2230%22%2C%22discussCommendCount%22:%221%22%2C%22onum%22:%2232%22%2C%22showPost%22:null%2C%22messageBubbleCount%22:%220%22%2C%22claimPoint%22:%220%22%2C%22token%22:%22eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxMzcxMDcxODQyNiIsImlhdCI6MTYxMDc2OTQ0OCwiZXhwIjoxNjQyMzA1NDQ4fQ.8JPqHi569U41JNP_XlJm0QMntRizpzBbVEXrjZbIwIoIBpj0FefC1GSXQyIKzmcPURZBkkCyaFemWFVNOmCtug%22%2C%22schoolAuthStatus%22:%222%22%2C%22userId%22:%222108548%22%2C%22vipToTime%22:%221694142241673%22%2C%22scoreUnit%22:%22%22%2C%22redPoint%22:%220%22%2C%22myTidings%22:%220%22%2C%22companyAuthStatus%22:%222%22%2C%22originalScore%22:%221366%22%2C%22myAnswerCount%22:%220%22%2C%22myQuestionCount%22:%220%22%2C%22signUp%22:%220%22%2C%22privateMessagePointWeb%22:%220%22%2C%22nickname%22:%22%E7%B1%B3%E5%A6%AE%C2%B7%E5%BE%B7%E7%91%9E%E4%BD%9B%22%2C%22privateMessagePoint%22:%220%22%2C%22bossStatus%22:%222%22%2C%22isClaim%22:%220%22%2C%22yellowDiamondEndTime%22:%220%22%2C%22isExpired%22:%220%22%2C%22yellowDiamondStatus%22:%22-1%22%2C%22pleaseAnswerCount%22:%221%22%2C%22bizCardUnread%22:%220%22%2C%22vnum%22:%220%22%2C%22mobile%22:%2213710718426%22%2C%22riskManagement%22:{%22servicePhone%22:null%2C%22mobile%22:13710718426%2C%22title%22:null%2C%22currentStatus%22:null%2C%22lastStatus%22:null%2C%22quickReturn%22:false%2C%22oldVersionMessage%22:null%2C%22riskMessage%22:null}}; tyc-user-info-save-time=1610769447960; auth_token=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxMzcxMDcxODQyNiIsImlhdCI6MTYxMDc2OTQ0OCwiZXhwIjoxNjQyMzA1NDQ4fQ.8JPqHi569U41JNP_XlJm0QMntRizpzBbVEXrjZbIwIoIBpj0FefC1GSXQyIKzmcPURZBkkCyaFemWFVNOmCtug; aliyungf_tc=116695395fdb183cccdef789246831e2e5a672d892cd98e4e9a213449d56ce0a; acw_tc=2760777d16107955249576288e0f4a9cb3bbefe2c82a1016a0304a90c6e21f; Hm_lvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610791381,1610791950,1610792636,1610795525; Hm_lpvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610795525',
            # 'TYCID=e27a6d40559e11ebb99e7790dd44c403; ssuid=5172384912; sensorsdata2015jssdkcross=%7B%22distinct_id%22%3A%22176fbd2d6f2772-09f3c54b622788-376b4502-2073600-176fbd2d6f37e%22%2C%22first_id%22%3A%22%22%2C%22props%22%3A%7B%22%24latest_traffic_source_type%22%3A%22%E7%9B%B4%E6%8E%A5%E6%B5%81%E9%87%8F%22%2C%22%24latest_search_keyword%22%3A%22%E6%9C%AA%E5%8F%96%E5%88%B0%E5%80%BC_%E7%9B%B4%E6%8E%A5%E6%89%93%E5%BC%80%22%2C%22%24latest_referrer%22%3A%22%22%7D%2C%22%24device_id%22%3A%22176fbd2d6f2772-09f3c54b622788-376b4502-2073600-176fbd2d6f37e%22%7D; _ga=GA1.2.223581965.1610542675; _gid=GA1.2.1866373621.1610542675; tyc-user-phone=%255B%252218001360007%2522%255D; __guid=32541557.3359825997812662300.1610543169505.4634; csrfToken=Y2eCDIhv_wO1VIJs0ZAsTY_l; bannerFlag=true; Hm_lvt_e92c8d65d92d534b0fc290df538b4758=1610542671,1610608825,1610609199,1610789974; Hm_lpvt_e92c8d65d92d534b0fc290df538b4758=1610795527; tyc-user-info={%22claimEditPoint%22:%220%22%2C%22explainPoint%22:%220%22%2C%22vipToMonth%22:%22false%22%2C%22personalClaimType%22:%22none%22%2C%22integrity%22:%2210%25%22%2C%22state%22:%227%22%2C%22score%22:%222367%22%2C%22surday%22:%22931%22%2C%22announcementPoint%22:%220%22%2C%22messageShowRedPoint%22:%220%22%2C%22bidSubscribe%22:%22-1%22%2C%22vipManager%22:%220%22%2C%22monitorUnreadCount%22:%2212%22%2C%22discussCommendCount%22:%221%22%2C%22onum%22:%2231%22%2C%22showPost%22:null%2C%22messageBubbleCount%22:%220%22%2C%22claimPoint%22:%220%22%2C%22token%22:%22eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxODAwMTM2MDAwNyIsImlhdCI6MTYxMDc5NTUzNywiZXhwIjoxNjQyMzMxNTM3fQ.uZUuZmXOXnaNUTt6cNo7IrNIrKdzAR-3llP8RAG157xKAN5nIUCcS5bgwdr96qaTb32PWOqKhSwEwHY80_YF5A%22%2C%22schoolAuthStatus%22:%222%22%2C%22userId%22:%227113334%22%2C%22vipToTime%22:%221691203842916%22%2C%22scoreUnit%22:%22%22%2C%22redPoint%22:%220%22%2C%22myTidings%22:%220%22%2C%22companyAuthStatus%22:%222%22%2C%22originalScore%22:%222367%22%2C%22myAnswerCount%22:%220%22%2C%22myQuestionCount%22:%220%22%2C%22signUp%22:%220%22%2C%22privateMessagePointWeb%22:%220%22%2C%22nickname%22:%22%E6%A2%B5%E9%AB%98%22%2C%22privateMessagePoint%22:%220%22%2C%22bossStatus%22:%222%22%2C%22isClaim%22:%220%22%2C%22yellowDiamondEndTime%22:%220%22%2C%22isExpired%22:%220%22%2C%22yellowDiamondStatus%22:%22-1%22%2C%22pleaseAnswerCount%22:%221%22%2C%22bizCardUnread%22:%220%22%2C%22vnum%22:%220%22%2C%22mobile%22:%2218001360007%22%2C%22riskManagement%22:{%22servicePhone%22:null%2C%22mobile%22:18001360007%2C%22title%22:null%2C%22currentStatus%22:null%2C%22lastStatus%22:null%2C%22quickReturn%22:false%2C%22oldVersionMessage%22:null%2C%22riskMessage%22:null}}; tyc-user-info-save-time=1610795536151; auth_token=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxODAwMTM2MDAwNyIsImlhdCI6MTYxMDc5NTUzNywiZXhwIjoxNjQyMzMxNTM3fQ.uZUuZmXOXnaNUTt6cNo7IrNIrKdzAR-3llP8RAG157xKAN5nIUCcS5bgwdr96qaTb32PWOqKhSwEwHY80_YF5A; acw_tc=2760825516107955376068438e89118fb7e84fb00aed57fd4ae27bbdc39bb5; monitor_count=88; Hm_lvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610786376,1610788214,1610789197,1610795538; Hm_lpvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610795538',
            # 'TYCID=2b6c4910559f11eb97fa591a3d04128d; ssuid=1752411008; sensorsdata2015jssdkcross=%7B%22distinct_id%22%3A%22176fbd4a78c306-013d9c6bd85c5d-c791039-1327104-176fbd4a78d405%22%2C%22first_id%22%3A%22%22%2C%22props%22%3A%7B%22%24latest_traffic_source_type%22%3A%22%E7%9B%B4%E6%8E%A5%E6%B5%81%E9%87%8F%22%2C%22%24latest_search_keyword%22%3A%22%E6%9C%AA%E5%8F%96%E5%88%B0%E5%80%BC_%E7%9B%B4%E6%8E%A5%E6%89%93%E5%BC%80%22%2C%22%24latest_referrer%22%3A%22%22%7D%2C%22%24device_id%22%3A%22176fbd4a78c306-013d9c6bd85c5d-c791039-1327104-176fbd4a78d405%22%7D; _ga=GA1.2.1085179612.1610542794; _gid=GA1.2.1115742951.1610542794; tyc-user-phone=%255B%252218693939800%2522%255D; bannerFlag=true; Hm_lvt_e92c8d65d92d534b0fc290df538b4758=1610542791,1610551246,1610608784,1610766132; csrfToken=Z2WebawkWJtRVwvbSPyKsdcg; Hm_lpvt_e92c8d65d92d534b0fc290df538b4758=1610795543; _gat_gtag_UA_123487620_1=1; tyc-user-info={%22claimEditPoint%22:%220%22%2C%22explainPoint%22:%220%22%2C%22vipToMonth%22:%22false%22%2C%22personalClaimType%22:%22none%22%2C%22integrity%22:%2210%25%22%2C%22state%22:%227%22%2C%22score%22:%222080%22%2C%22surday%22:%2256%22%2C%22announcementPoint%22:%220%22%2C%22messageShowRedPoint%22:%220%22%2C%22bidSubscribe%22:%22-1%22%2C%22vipManager%22:%220%22%2C%22monitorUnreadCount%22:%2285%22%2C%22discussCommendCount%22:%221%22%2C%22onum%22:%2273%22%2C%22showPost%22:null%2C%22messageBubbleCount%22:%220%22%2C%22claimPoint%22:%220%22%2C%22token%22:%22eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxODY5MzkzOTgwMCIsImlhdCI6MTYxMDc5NTU2NCwiZXhwIjoxNjQyMzMxNTY0fQ.TBcuKmJihEGcz2D0DIBaUeBU-jNHjiSAcIAgRpWRSE3LxckK--GYyYJOL-Jv2iddoLLy2hqaSHCnVSVJvF82Rw%22%2C%22schoolAuthStatus%22:%222%22%2C%22userId%22:%2212069430%22%2C%22vipToTime%22:%221615628963432%22%2C%22scoreUnit%22:%22%22%2C%22redPoint%22:%220%22%2C%22myTidings%22:%220%22%2C%22companyAuthStatus%22:%222%22%2C%22originalScore%22:%222080%22%2C%22myAnswerCount%22:%220%22%2C%22myQuestionCount%22:%220%22%2C%22signUp%22:%220%22%2C%22privateMessagePointWeb%22:%220%22%2C%22nickname%22:%22%E5%A5%88%E5%BE%B7%22%2C%22privateMessagePoint%22:%220%22%2C%22bossStatus%22:%222%22%2C%22isClaim%22:%220%22%2C%22yellowDiamondEndTime%22:%220%22%2C%22isExpired%22:%220%22%2C%22yellowDiamondStatus%22:%22-1%22%2C%22pleaseAnswerCount%22:%220%22%2C%22bizCardUnread%22:%220%22%2C%22vnum%22:%2250%22%2C%22mobile%22:%2218693939800%22%2C%22riskManagement%22:{%22servicePhone%22:null%2C%22mobile%22:18693939800%2C%22title%22:null%2C%22currentStatus%22:null%2C%22lastStatus%22:null%2C%22quickReturn%22:false%2C%22oldVersionMessage%22:null%2C%22riskMessage%22:null}}; tyc-user-info-save-time=1610795563596; auth_token=eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxODY5MzkzOTgwMCIsImlhdCI6MTYxMDc5NTU2NCwiZXhwIjoxNjQyMzMxNTY0fQ.TBcuKmJihEGcz2D0DIBaUeBU-jNHjiSAcIAgRpWRSE3LxckK--GYyYJOL-Jv2iddoLLy2hqaSHCnVSVJvF82Rw; acw_tc=2760821616107955650164178efd15ca01e09484268395923ce4cef05aa837; Hm_lvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610789968,1610790389,1610791379,1610795566; Hm_lpvt_1c93ed18b9ecc941567e9f8a07cb6a61=1610795566',
            ]
        self.headers = {  # 请求头
            'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9',
            'Accept-Encoding': 'gzip, deflate, br',
            'Accept-Language': 'zh-CN,zh-TW;q=0.9,zh;q=0.8,en-US;q=0.7,en;q=0.6',
            'Upgrade-Insecure-Requests': '1',
            'User-Agent': 'Mozilla/5.0(Windows NT 10.0;Win64;x64) '
                          'Gecko/20100101 '
                          'Firefox/84.0 '
                          'AppleWebKit/537.36(KHTML,likeGecko) '
                          'Chrome/87.0.4280.141 '
                          'Safari/537.36',
            'Host': 'zhuanli.tianyancha.com',
            'Connection': 'keep-alive',
            'Sec-Fetch-User': '?1',
        }
        self.code_company = None  # 查询的公司

    def read_companies(self):
        """ 多进程爬取信息 """
        try:
            data = pd.read_csv('公司名单.csv',  encoding='gb18030')  # 读取公司名单
            pool = Pool(processes=8)  # 创建多进程
            for i in range(0, data.shape[0]):  # 存储同时爬取的公司
                self.code_company = data.values[i]
                length = self.get_length(self.code_company)  # 提前判断公司是否有专利，减少爬取时间
                if length is None:
                    info = {
                        'code': self.code_company[0],
                        'name': self.code_company[1],
                        'full_name': self.code_company[2],
                        'IPC': '无',  # 查找编号
                        'title': '无'
                    }
                    print(info)
                    self._write_to_csv([info])
                    continue
                items = []  # 存儲同時爬取的頁面
                try:
                    for j in range(1, int(length / 20) + 2):
                        items.append(j)
                    pool.map(self._request, items)
                    print(f'----{self.code_company[2]}公司查询结束，开始新一轮爬取----')
                except Exception as e:
                    print(f'并发进程错误：{e}')
                finally:
                    time.sleep(5)
        except Exception as e:
            print(f'读取公司错误：{e}')

    def _write_to_csv(self, data):
        """ 写入文件 """
        df = pd.DataFrame(data)
        try:
            df.to_csv('复查.csv', encoding="gb2312", mode='a', index=False, header=False)
            print('数据写入成功')
        except Exception as e:
            print(f'写入文件错误：{e}')

    def get_length(self, code_company):
        """ 获取公司专利数量 """
        try:
            time.sleep(3)  # 睡眠
            print(f'{code_company[2]} 开始请求')
            self.headers.update({'Cookie': self.cookie[random.randint(0, 8)]})  # 从cookie池中随机选取cookie
            resp = requests.get(f'{self.base_url}/{code_company[2]}/p1', headers=self.headers, timeout=5)
            if resp.status_code == 200:  # 成功状态处理
                soup = BeautifulSoup(resp.content.decode('utf-8'), 'lxml')
                no_result = soup.find('div', attrs={'class': 'no-result'})  # 当前页是否存在数据
                if no_result is not None:
                    return
                # 如果存在专利，获取该公司专利总数
                length = soup.find('div', attrs={'class': 'result-tips'}).find('span', attrs={'class': 'zhuanli-name'}).get_text()  # 专利总数
                if '+' in length:
                    length = length[:-1]
                return int(length)
            else:
                # 404 需要输入验证码
                time.sleep(5)
                if resp.status_code == 404:
                    print(f'{resp.status_code} 需要输入验证码--- 3秒后重新请求!!!')
                else:
                    print(f'服务器请求错误: {resp.status_code} 3秒后重新请求!!!')
                self.get_length(code_company)
        except Exception as e:
            print(f'request 函数错误：{e}')
            self.get_length(code_company)

    def _request(self, patent_index):
        """ 请求指定页数页面 """
        try:
            print(f'开始爬取第 {patent_index} 页')
            time.sleep(random.randint(4, 10))
            print(f'{self.base_url}/{self.code_company[2]}/p{patent_index}')
            self.headers.update({'Cookie': self.cookie[random.randint(0, 11)]})  # 更新cookie
            resp = requests.get(f'{self.base_url}/{self.code_company[2]}/p{patent_index}', headers=self.headers, timeout=5)
            if resp.status_code == 200:  # 成功状态处理
                print(f'爬取 {self.code_company[2]} 第 {patent_index} 页')
                soup = BeautifulSoup(resp.content.decode(), 'lxml')  # 解析页面
                no_result = soup.find('div', attrs={'class': 'no-result'})  # 当前页数据是否为空
                patents = soup.find_all('div', attrs={'class': 'search-result-single'})  # 检索所有专利信息
                if no_result is not None and len(patents) == 0:
                    print(f'结果为空！！ {no_result}')
                    return
                for item in patents:
                    link = item.find('div', attrs={'class': 'header'}).find('a')['href']  # 详细链接
                    title = item.find('div', attrs={'class': 'header'}).find('a').get_text()  # 名称
                    self._get_code(self.code_company, title, link)
            else:
                # 404 需要输入验证码
                time.sleep(5)
                if resp.status_code == 404:
                    print(f'{resp.status_code} 需要输入验证码--- 3秒后重新请求!!! ：{self.headers["Cookie"]}')
                else:
                    print(f'服务器请求错误: {resp.status_code} 3秒后重新请求!!!')
                self._request(patent_index)
        except Exception as e:
            print(f'request 函数错误：{e}')
            self._request(patent_index)

    def _get_code(self, code_company, title, link):
        try:
            time.sleep(random.randint(2, 8))  # 睡眠
            self.headers.update({'Cookie': self.cookie[random.randint(0, 11)]})
            resp = requests.get(link, headers=self.headers, timeout=5)
            if resp.status_code == 200:  # 成功状态处理
                soup = BeautifulSoup(resp.content.decode('utf-8'), 'lxml')
                status = soup.find('span', attrs={'class': 'tag-common'})  # 专利状态(只保留有效)
                if status is None:
                    status = '有效'
                else:
                    status = status.get_text()
                IPC = soup.find('table', attrs={'class': 'table'}).find_all('tr')[3].find_all('td')[1].get_text()
                print(status)  # 打印专利状态（在审，有效）
                if status == '有效' and IPC != '-':
                    info = {
                        'code': code_company[0],
                        'name': code_company[1],
                        'full_name': code_company[2],
                        'IPC': IPC,  # 查找编号
                        'title': title
                    }
                    print(info)
                    self._write_to_csv([info])
            else:
                print(f'获取html页面错误：{resp.status_code} -- 3秒后重试 : {self.headers["Cookie"]}')
                time.sleep(random.randint(2, 5))
                self._get_code(code_company, title, link)
        except UnicodeError as e:
            print(f'编码错误:{e}')
            return
        except Exception as e:
            print(f'获取html页面错误：{e} -- 3秒后重试')
            time.sleep(random.randint(2, 5))
            self._get_code(code_company, title, link)


if __name__ == '__main__':
    p = TianYanCha()
    p.read_companies()

